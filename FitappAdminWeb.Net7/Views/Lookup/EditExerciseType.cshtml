@model ExerciseTypeEditViewModel
@{
}

<form id="exertype_editor" asp-action="EditExerciseType" method="post">
    <div class="form-group">
        <input type="hidden" id="editmode" value="@(Model.Data.Id > 0)" />
        <input type="hidden" asp-for="Data.Id" />
        <fieldset>
            <legend>
                @if (Model.Data.Id == 0)
                {
                    <span>Add New Exercise Type</span>
                }
                else
                {
                    <span>Edit Exercise Type <span class="text-muted">(ID: @Model.Data.Id)</span></span>
                }
            </legend>
        </fieldset>
        <div class="row mb-3">
            <div class="col">
                <label asp-for="Data.Name">Name</label>
                <input class="form-control" type="text" asp-for="Data.Name" placeholder="Name" required data-bind="value: Name"/>                              
            </div>
        </div>
        <div class="row mb-3">
            <div class="col">
                <label asp-for="Data.ExplainerTextFr" placeholder="Explanation">Explanation</label>
                <textarea class="form-control" rows="3" asp-for="Data.ExplainerTextFr" data-bind="value: ExplainerTextFr"></textarea>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col">
                <label asp-for="Data.ExplainerVideoFr">Instruction Video Link URL</label>
                <input type="text" class="form-control" asp-for="Data.ExplainerVideoFr" placeholder="Instruction Video Link URL" data-bind="value: ExplainerVideoFr" />
            </div>
        </div>
        <div class="row mb-3">
            <h4>Exercise Type Properties</h4>
            <span class="form-text">Note that you can use custom values by selecting "Custom" and filling the Free Text column. After saving, this new value can be selected for that property for new exercise types later. </span>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">        
                <label asp-for="Data.FkLevelId">Level</label>
                <select asp-for="Data.FkLevelId" class="form-select" asp-items="Model.Level_List" data-bind="value: FkLevelId" required>
                    <option value="">Select..</option>
                    <option value="0">Custom..</option>
                </select>                                                   
            </div>
            <div class="col-md-6">
                <label asp-for="Data.LevelFreeText">Level Free Text</label>
                <input type="text" asp-for="Data.LevelFreeText" class="form-control" placeholder="Level Free Text" data-bind="value: LevelFreeText, enable: EnableLevelFreeText" />
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">             
                <label asp-for="Data.FkExerciseClassId">Exercise Class</label>
                <select asp-for="Data.FkExerciseClassId" class="form-select" asp-items="Model.ExerciseClass_List" data-bind="value: FkExerciseClassId" required>
                    <option value="">Select..</option>
                    <option value="0">Custom..</option>
                </select>                  
            </div>
            <div class="col-md-6">        
                <label asp-for="Data.ExerciseClassFreeText">Exercise Class Free Text</label>
                <input type="text" asp-for="Data.ExerciseClassFreeText" class="form-control" placeholder="Exercise Class Free Text" data-bind="value: ExerciseClassFreeText, enable: EnableExerciseClassFreeText" />
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
                <label asp-for="Data.FkForceId">Force</label>
                <select asp-for="Data.FkForceId" class="form-select" asp-items="Model.Force_List" data-bind="value: FkForceId" required>
                    <option value="">Select..</option>
                    <option value="0">Custom..</option>
                </select>
            </div>
            <div class="col-md-6">
                <label asp-for="Data.ForceFreeText">Force Free Text</label>
                <input type="text" asp-for="Data.ForceFreeText" class="form-control" placeholder="Force Free Text" data-bind="value: ForceFreeText, enable: EnableForceFreeText" />
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
                <label asp-for="Data.FkEquipmentId">Equipment</label>
                <select asp-for="Data.FkEquipmentId" class="form-select" asp-items="Model.Equipment_List" data-bind="value: FkEquipmentId" required>
                    <option value="">Select..</option>
                    <option value="0">Custom..</option>
                </select>
            </div>
            <div class="col-md-6">
                <label asp-for="Data.EquipmentFreeText">Equipment Free Text</label>
                <input type="text" asp-for="Data.EquipmentFreeText" class="form-control" placeholder="Equipment Free Text" data-bind="value: EquipmentFreeText, enable: EnableEquipmentFreeText" />
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
                <label asp-for="Data.FkSportId">Sport</label>
                <select asp-for="Data.FkSportId" class="form-select" asp-items="Model.Sport_List" data-bind="value: FkSportId" required>
                    <option value="">Select..</option>
                    <option value="0">Custom..</option>
                </select>
            </div>
            <div class="col-md-6">
                <label asp-for="Data.SportFreeText">Sport Free Text</label>
                <input type="text" asp-for="Data.SportFreeText" class="form-control" placeholder="Sport Free Text" data-bind="value: SportFreeText, enable: EnableSportFreeText" />
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
                <label asp-for="Data.FkMechanicsTypeId">Mechanics Type</label>
                <select asp-for="Data.FkMechanicsTypeId" class="form-select" asp-items="Model.MechanicsType_List" data-bind="value: FkMechanicsTypeId" required>
                    <option value="">Select..</option>
                    <option value="0">Custom..</option>
                </select>
            </div>
            <div class="col-md-6">
                <label asp-for="Data.MechanicsTypeFreeText">Mechanics Type Free Text</label>
                <input type="text" asp-for="Data.MechanicsTypeFreeText" class="form-control" placeholder="Mechanics Type Free Text" data-bind="value: MechanicsTypeFreeText, enable: EnableMechanicsTypeFreeText" />
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
                <label asp-for="Data.FkMainMuscleWorkedId">Main Muscle Worked</label>
                <select asp-for="Data.FkMainMuscleWorkedId" class="form-select" asp-items="Model.MainMuscle_List" data-bind="value: FkMainMuscleWorkedId" required>
                    <option value="">Select..</option>
                    <option value="0">Custom..</option>
                </select>
            </div>
            <div class="col-md-6">
                <label asp-for="Data.MainMuscleWorkedFreeText">Main Muscle Worked Free Text</label>
                <input type="text" asp-for="Data.MainMuscleWorkedFreeText" class="form-control" placeholder="Main Muscle Worked Free Text" data-bind="value: MainMuscleWorkedFreeText, enable: EnableMainMuscleWorkedFreeText" />
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
                <label asp-for="Data.FkOtherMuscleWorkedId">Other Muscle Worked</label>
                <select asp-for="Data.FkOtherMuscleWorkedId" class="form-select" asp-items="Model.OtherMuscle_List" data-bind="value: FkOtherMuscleWorkedId" required>
                    <option value="">Select..</option>
                    <option value="0">Custom..</option>
                </select>
            </div>
            <div class="col-md-6">
                <label asp-for="Data.OtherMuscleFreeText">Other Muscle Worked Free Text</label>
                <input type="text" asp-for="Data.OtherMuscleFreeText" class="form-control" placeholder="Other Muscle Worked Free Text" data-bind="value: OtherMuscleFreeText, enable: EnableOtherMainMuscleWorkedFreeText" />
            </div>
        </div>
        <div class="row mb-3">
            <h4>Set Defaults</h4>
            <span class="form-text">When adding exercises, these sets will be added by default to the created exercise.</span>
            <div class="mt-3">
                <button class="btn btn-outline-primary" data-bind="click: AddSetDefault">
                    <i data-feather="plus"></i><span class="me-2">Add Set Default</span>
                </button>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col">
                <div class="list-group" data-bind="foreach: SetDefaults">
                    <div class="list-group-item">
                        <div class="row">
                            <input type="hidden" data-bind="value: Id" />
                            <div class="col-auto col-form-label fw-bold">
                                Set # <span data-bind="text: $index"></span> <span class="text-muted">(ID: <span data-bind="text: Id"></span>)</span>
                            </div>
                            <div class="col-auto">
                                <button type="button" class="btn btn-link" data-bind="click: AddMetricDefault">Add Metric..</button>
                            </div>
                            <div class="col">
                                <button type="button" class="btn btn-close float-end" data-bind="click: $parent.RemoveSetDefault"></button>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="list-group list-group-flush" data-bind="foreach: SetMetricDefaults">
                                <div class="list-group-item">
                                    <div class="row">
                                        <div class="col">
                                            <input type="hidden" data-bind="value: Id" />
                                            <input type="text" class="form-control" data-bind="value: DefaultCustomMetric" />
                                        </div>
                                        <div class="col">
                                            <select class="form-select" asp-items="Model.SetMetricType_List" data-bind="value: FkSetMetricTypeId"></select>
                                        </div>
                                        <div class="col">
                                            <button type="button" class="btn btn-close" data-bind="click: $parent.RemoveMetricDefault"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex justify-content-end">
            <a class="btn btn-link" asp-action="ExerciseType">Cancel</a>
            <button type="button" class="btn btn-primary" data-bind="click: SubmitModel">Save</button>            
        </div>
    </div>
</form>

@section Scripts {
    <script asp-src-include="lib/knockout/knockout-latest.debug.js"></script>
    <script src="~/lib/managed/extype_edit.js"></script>
    <script>
        window.fitapp.ExerTypeEdit.Initialize();
    </script>
}